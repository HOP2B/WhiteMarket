{"version":3,"sources":["../../../../pages/checkout.tsx","../../../../node_modules/next/src/build/templates/pages.ts"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/router\";\nimport Navbar from \"../components/Navbar\";\nimport { useAuth } from \"../context/AuthContext\";\nimport { getGigById, createOrder } from \"../api/mockApi\";\n\nconst CheckoutPage: React.FC = () => {\n  const { user } = useAuth();\n  const router = useRouter();\n  const { gigId } = router.query;\n  const [gig, setGig] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n  const [processing, setProcessing] = useState(false);\n\n  useEffect(() => {\n    const fetchGig = async () => {\n      if (gigId && typeof gigId === \"string\") {\n        try {\n          const gigData = await getGigById(gigId);\n          setGig(gigData);\n        } catch (error) {\n          console.error(\"Error fetching gig:\", error);\n        }\n      }\n      setLoading(false);\n    };\n\n    fetchGig();\n  }, [gigId]);\n\n  const handleQPayPayment = async () => {\n    if (!gig || !user) return;\n\n    setProcessing(true);\n    try {\n      // QPay Integration Simulation\n      // In production, this would use QPay's API/SDK\n\n      // Step 1: Create invoice with QPay\n      const invoiceData = {\n        amount: gig.price,\n        currency: \"MNT\",\n        description: `Payment for ${gig.title}`,\n        callback_url: `${window.location.origin}/payment/callback`,\n        merchant_id: process.env.NEXT_PUBLIC_QPAY_MERCHANT_ID,\n      };\n\n      // Simulate QPay API call\n      console.log(\"Creating QPay invoice:\", invoiceData);\n\n      // Simulate API response\n      const qpayResponse = {\n        invoice_id: `QPAY_${Date.now()}`,\n        qr_code: \"https://api.qpay.mn/v2/qr?invoice_id=QPAY_\" + Date.now(),\n        payment_url: \"https://qpay.mn/payment/\" + Date.now(),\n      };\n\n      // Step 2: Create order (simulate - database not set up yet)\n      const order = {\n        id: Date.now().toString(),\n        gig_id: gig.id,\n        buyer_id: user.id,\n        seller_id: gig.userId,\n        amount: gig.price,\n        status: \"pending\",\n        qpay_invoice_id: qpayResponse.invoice_id,\n        created_at: new Date().toISOString(),\n      };\n\n      console.log(\"Creating order:\", order);\n      // await createOrder(order); // Commented out until database is set up\n\n      // Step 3: Redirect to QPay payment page or show QR code\n      // For demo purposes, we'll simulate successful payment\n      setTimeout(async () => {\n        // Update order status to completed\n        const updatedOrder = { ...order, status: \"completed\" };\n        // In real app, this would be done via webhook\n\n        alert(\n          `QPay төлбөр амжилттай! ₮${gig.price.toLocaleString()} төлөгдлөө.`,\n        );\n        router.push(\"/dashboard\");\n      }, 3000);\n    } catch (error) {\n      console.error(\"QPay payment error:\", error);\n      alert(\"Төлбөр амжилтгүй боллоо. Дахин оролдоно уу.\");\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-600\"></div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen bg-gray-50\">\n        <Navbar />\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">\n            Please login to checkout\n          </h1>\n        </div>\n      </div>\n    );\n  }\n\n  if (!gig) {\n    return (\n      <div className=\"min-h-screen bg-gray-50\">\n        <Navbar />\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">Gig not found</h1>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Navbar />\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">Checkout</h1>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n          <div className=\"bg-white rounded-lg shadow-md p-6\">\n            <h2 className=\"text-xl font-bold text-gray-900 mb-4\">\n              Order Summary\n            </h2>\n            <div className=\"flex items-center mb-4\">\n              <img\n                src={gig.userAvatar}\n                alt={gig.userName}\n                className=\"w-12 h-12 rounded-full mr-4\"\n              />\n              <div>\n                <h3 className=\"font-semibold text-gray-900\">{gig.title}</h3>\n                <p className=\"text-sm text-gray-600\">by {gig.userName}</p>\n              </div>\n            </div>\n            <p className=\"text-gray-600 mb-4\">{gig.description}</p>\n            <div className=\"border-t pt-4\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-lg font-semibold\">Нийт:</span>\n                <span className=\"text-2xl font-bold text-green-600\">\n                  ₮{gig.price.toLocaleString()}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-lg shadow-md p-6\">\n            <h2 className=\"text-xl font-bold text-gray-900 mb-4\">Payment</h2>\n            <div>\n              <p className=\"text-gray-600 mb-4\">\n                Ready to hire this freelancer? Click below to complete your\n                payment.\n              </p>\n              <button\n                onClick={handleQPayPayment}\n                disabled={processing}\n                className=\"w-full bg-green-600 text-white py-3 px-4 rounded-md hover:bg-green-700 disabled:opacity-50\"\n              >\n                {processing\n                  ? \"QPay төлбөр боловсруулж байна...\"\n                  : `QPay-р төлөх ₮${gig.price.toLocaleString()}`}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CheckoutPage;\n","import { PagesRouteModule } from '../../server/route-modules/pages/module.compiled'\nimport { RouteKind } from '../../server/route-kind'\n\nimport { hoist } from './helpers'\n\n// Import the app and document modules.\nimport * as document from 'VAR_MODULE_DOCUMENT'\nimport * as app from 'VAR_MODULE_APP'\n\n// Import the userland code.\nimport * as userland from 'VAR_USERLAND'\nimport { getHandler } from '../../server/route-modules/pages/pages-handler'\n\n// Re-export the component (should be the default export).\nexport default hoist(userland, 'default')\n\n// Re-export methods.\nexport const getStaticProps = hoist(userland, 'getStaticProps')\nexport const getStaticPaths = hoist(userland, 'getStaticPaths')\nexport const getServerSideProps = hoist(userland, 'getServerSideProps')\nexport const config = hoist(userland, 'config')\nexport const reportWebVitals = hoist(userland, 'reportWebVitals')\n\n// Re-export legacy methods.\nexport const unstable_getStaticProps = hoist(\n  userland,\n  'unstable_getStaticProps'\n)\nexport const unstable_getStaticPaths = hoist(\n  userland,\n  'unstable_getStaticPaths'\n)\nexport const unstable_getStaticParams = hoist(\n  userland,\n  'unstable_getStaticParams'\n)\nexport const unstable_getServerProps = hoist(\n  userland,\n  'unstable_getServerProps'\n)\nexport const unstable_getServerSideProps = hoist(\n  userland,\n  'unstable_getServerSideProps'\n)\n\n// Create and export the route module that will be consumed.\nexport const routeModule = new PagesRouteModule({\n  definition: {\n    kind: RouteKind.PAGES,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n  },\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n  components: {\n    // default export might not exist when optimized for data only\n    App: app.default,\n    Document: document.default,\n  },\n  userland,\n})\n\nexport const handler = getHandler({\n  srcPage: 'VAR_DEFINITION_PAGE',\n  config,\n  userland,\n  routeModule,\n  getStaticPaths,\n  getStaticProps,\n  getServerSideProps,\n})\n"],"names":["PagesRouteModule","RouteKind","hoist","document","app","userland","getHandler","getStaticProps","getStaticPaths","getServerSideProps","config","reportWebVitals","unstable_getStaticProps","unstable_getStaticPaths","unstable_getStaticParams","unstable_getServerProps","unstable_getServerSideProps","routeModule","definition","kind","PAGES","page","pathname","bundlePath","filename","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","components","App","default","Document","handler","srcPage"],"mappings":"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","ignoreList":[1]}