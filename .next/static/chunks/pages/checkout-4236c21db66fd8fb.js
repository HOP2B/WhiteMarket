(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[732],{1898:(e,s,t)=>{"use strict";t.d(s,{A:()=>m});var a=t(7876),r=t(4232),l=t(8230),i=t.n(l),n=t(8070),c=t(7279),d=t(4525),o=t(9099);let x=()=>{let{notifications:e,unreadCount:s,isLoading:t,markAsRead:r,markAllAsRead:l,deleteNotification:i,showNotifications:n,toggleNotifications:d}=(0,c.E)(),x=(0,o.useRouter)(),m=async e=>{e.read||await r(e.id),e.actionUrl&&x.push(e.actionUrl),d()};return n?(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Мэдэгдэл"}),s>0&&(0,a.jsx)("button",{onClick:l,className:"text-sm text-green-600 hover:text-green-700",children:"Бүгдийг уншсан болгох"})]})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:t?(0,a.jsx)("div",{className:"p-4 text-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-green-600 mx-auto"})}):e.length>0?e.map(e=>(0,a.jsx)("div",{className:"p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer ".concat(e.read?"":"bg-blue-50"),onClick:()=>m(e),children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"text-2xl",children:(e=>{switch(e){case"order":return"\uD83D\uDCE6";case"message":return"\uD83D\uDCAC";case"payment":return"\uD83D\uDCB3";case"system":return"\uD83D\uDD14";default:return"\uD83D\uDCE2"}})(e.type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),!e.read&&(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:(e=>{let s=new Date,t=new Date(e),a=Math.floor((s.getTime()-t.getTime())/6e4);if(a<1)return"Дөнгөж сая";if(a<60)return"".concat(a," мин өмнө");let r=Math.floor(a/60);if(r<24)return"".concat(r," цаг өмнө");let l=Math.floor(r/24);return l<7?"".concat(l," өдөр өмнө"):t.toLocaleDateString("mn-MN")})(e.createdAt)})]}),(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),i(e.id)},className:"text-gray-400 hover:text-red-600 text-sm p-1",title:"Устгах",children:"✕"})]})},e.id)):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-3",children:"\uD83D\uDD14"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Мэдэгдэл байхгүй байна"})]})}),e.length>0&&(0,a.jsx)("div",{className:"p-3 border-t border-gray-200 text-center",children:(0,a.jsx)("button",{onClick:()=>{x.push("/notifications"),d()},className:"text-sm text-green-600 hover:text-green-700",children:"Бүх мэдэгдлийг харах"})})]}):null},m=()=>{let{user:e}=(0,n.A)(),{unreadCount:s,toggleNotifications:t}=(0,c.E)(),[l,o]=(0,r.useState)(!1);return(0,a.jsx)("nav",{className:"bg-white shadow-md border-b border-gray-200 sticky top-0 z-50 backdrop-blur-sm bg-opacity-95 transition-all duration-300",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16 lg:grid lg:grid-cols-3 lg:items-center",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(i(),{href:"/",className:"flex items-center",children:(0,a.jsx)("span",{className:"text-2xl font-bold text-gradient",children:"White Market"})})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"flex items-center hidden md:block",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search services...",className:"input-field pl-10 pr-4 py-2 w-64"}),(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),e?(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(i(),{href:"/jobs",className:"px-4 py-2 text-text-gray-600 hover:text-gray-900-color hover:bg-bg-gray-100 rounded-lg transition-all duration-200 font-medium",children:"Үйлчилгээ"}),(0,a.jsx)(i(),{href:"/dashboard",className:"px-4 py-2 text-text-gray-600 hover:text-gray-900-color hover:bg-bg-gray-100 rounded-lg transition-all duration-200 font-medium",children:"Dashboard"}),(0,a.jsx)(i(),{href:"/messages",className:"px-4 py-2 text-text-gray-600 hover:text-gray-900-color hover:bg-bg-gray-100 rounded-lg transition-all duration-200 font-medium",children:"Messages"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:t,className:"relative p-2 text-text-gray-600 hover:text-gray-900-color hover:bg-bg-gray-100 rounded-lg transition-all duration-200",title:"Мэдэгдэл",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDD14"}),s>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse-subtle",children:s>9?"9+":s})]}),(0,a.jsx)(x,{})]}),(0,a.jsx)("div",{className:"ml-4",children:(0,a.jsx)(d.uF,{appearance:{elements:{avatarBox:"w-8 h-8 border-2 border-blue-600",userButtonTrigger:"p-1"}}})})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(i(),{href:"/login",className:"px-4 py-2 text-text-gray-600 hover:text-gray-900-color hover:bg-bg-gray-100 rounded-lg transition-all duration-200 font-medium",children:"Login"}),(0,a.jsx)(i(),{href:"/register",className:"btn-primary px-6 py-2 text-sm",children:"Sign Up"})]})]})]})})})}},5620:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var a=t(7876),r=t(4232),l=t(9099),i=t(1898),n=t(8070),c=t(9252),d=t(5364);let o=()=>{let{user:e}=(0,n.A)(),s=(0,l.useRouter)(),{gigId:t}=s.query,[o,x]=(0,r.useState)(null),[m,h]=(0,r.useState)(!0),[u,g]=(0,r.useState)(!1),[p,b]=(0,r.useState)("qpay"),[j,y]=(0,r.useState)(""),[N,f]=(0,r.useState)(0),[v,w]=(0,r.useState)(!1),[M,I]=(0,r.useState)({requirements:"",deliveryDate:"",specialInstructions:""}),D=()=>o?o.price-N:0,k=async()=>{if(o&&e){if(!M.requirements.trim())return void alert("Үйлчилгээний шаардлагыг оруулна уу!");if(!M.deliveryDate)return void alert("Дуусгах огноог сонгоно уу!");g(!0);try{"qpay"===p?await S():"socialpay"===p?await A():"bank"===p&&await C()}catch(e){console.error("Payment error:",e),alert("Төлбөр амжилтгүй боллоо. Дахин оролдоно уу.")}finally{g(!1)}}},A=async()=>{alert("Social Pay төлбөрийн интеграц хөгжүүлэгдэж байна. QPay-р төлнө үү.")},C=async()=>{alert("Банкны шилжүүлэг хүлээн авлаа. Баталгаажуулалт 1-2 ажлын өдөр үргэлжилнэ."),s.push("/dashboard")};(0,r.useEffect)(()=>{(async()=>{if(t&&"string"==typeof t)try{let e=await (0,c.kd)(t);x(e)}catch(e){console.error("Error fetching gig:",e)}h(!1)})()},[t]);let S=async()=>{if(o&&e){g(!0);try{let t={amount:o.price,currency:"MNT",description:"Payment for ".concat(o.title),callback_url:"".concat(window.location.origin,"/payment/callback"),merchant_id:d.env.NEXT_PUBLIC_QPAY_MERCHANT_ID};console.log("Creating QPay invoice:",t);let a={invoice_id:"QPAY_".concat(Date.now()),qr_code:"https://api.qpay.mn/v2/qr?invoice_id=QPAY_"+Date.now(),payment_url:"https://qpay.mn/payment/"+Date.now()},r={id:Date.now().toString(),gig_id:o.id,buyer_id:e.id,seller_id:o.userId,amount:o.price,status:"pending",qpay_invoice_id:a.invoice_id,created_at:new Date().toISOString()};console.log("Creating order:",r),setTimeout(async()=>{alert("QPay төлбөр амжилттай! ₮".concat(o.price.toLocaleString()," төлөгдлөө.")),s.push("/dashboard")},3e3)}catch(e){console.error("QPay payment error:",e),alert("Төлбөр амжилтгүй боллоо. Дахин оролдоно уу.")}finally{g(!1)}}};return m?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})}):e?o?(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)(i.A,{}),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Тооцоо хийх"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Захиалгын дэлгэрэнгүй"}),(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("img",{src:o.userAvatar||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiNFNUU3RUIiLz4KPHBhdGggZD0iTTIwIDIwQzIyLjc2MTQgMjAgMjUgMTcuNzYxNCAyNSAxNUMyNSAxMi4yMzg2IDIyLjc2MTQgMTAgMjAgMTBDMTcuMjM4NiAxMCAxNSAxMi4yMzg2IDE1IDE1QzE1IDE3Ljc2MTQgMTcuNzYxNCAyMCAyMFoiIGZpbGw9IiM5Q0E0QUYiLz4KPHBhdGggZD0iTTMwIDI4QzMwIDI0LjY4NjMgMjYuNDI3MSAyMiAyMiAyMkgxOEMxMy41NzI5IDIyIDEwIDI0LjY4NjMgMTAgMjhWMzBIMzBWMjhaIiBmaWxsPSIjOUNBNEFGIi8+Cjwvc3ZnPgo=",alt:o.userName,className:"w-12 h-12 rounded-full mr-4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:o.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["by ",o.userName]})]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:o.description}),(0,a.jsxs)("div",{className:"border-t pt-4 mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Промо код"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"text",value:j,onChange:e=>y(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Промо код оруулна уу"}),(0,a.jsx)("button",{onClick:()=>{"discount10"===j.toLowerCase()?(f(o?.1*o.price:0),alert("10% хөнгөлөлт амжилттай хэрэглэгдлээ!")):"welcome20"===j.toLowerCase()?(f(o?.2*o.price:0),alert("20% хөнгөлөлт амжилттай хэрэглэгдлээ!")):(alert("Буруу промо код!"),f(0))},className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Хэрэглэх"})]})]}),(0,a.jsxs)("div",{className:"border-t pt-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Үндсэн үнэ:"}),(0,a.jsxs)("span",{children:["₮",o.price.toLocaleString()]})]}),N>0&&(0,a.jsxs)("div",{className:"flex justify-between text-blue-600",children:[(0,a.jsx)("span",{children:"Хөнгөлөлт:"}),(0,a.jsxs)("span",{children:["-₮",N.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t",children:[(0,a.jsx)("span",{className:"text-lg font-semibold",children:"Нийт:"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:["₮",D().toLocaleString()]})]})]})]})}),(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Захиалгын мэдээлэл"}),(0,a.jsx)("button",{onClick:()=>w(!v),className:"text-blue-600 hover:text-blue-700 text-sm",children:v?"Хураах":"Дэлгэрэнгүй"})]}),v&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Таны шаардлага *"}),(0,a.jsx)("textarea",{value:M.requirements,onChange:e=>I({...M,requirements:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"Үйлчилгээний талаархи дэлгэрэнгүй шаардлага, хүссэн үр дүн зэргийг бичнэ үү..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Дуусгах огноо *"}),(0,a.jsx)("input",{type:"date",value:M.deliveryDate,onChange:e=>I({...M,deliveryDate:e.target.value}),min:new Date(Date.now()+864e5).toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Нэмэлт заавар"}),(0,a.jsx)("textarea",{value:M.specialInstructions,onChange:e=>I({...M,specialInstructions:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Нэмэлт тайлбар, файлын линк зэрэг..."})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Төлбөрийн арга сонгох"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",id:"qpay",name:"paymentMethod",value:"qpay",checked:"qpay"===p,onChange:e=>b(e.target.value),className:"mr-3"}),(0,a.jsxs)("label",{htmlFor:"qpay",className:"flex items-center cursor-pointer",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center mr-3",children:(0,a.jsx)("span",{className:"text-blue-600 font-semibold text-sm",children:"QP"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"QPay"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Шуурхай, аюулгүй төлбөр"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",id:"socialpay",name:"paymentMethod",value:"socialpay",checked:"socialpay"===p,onChange:e=>b(e.target.value),className:"mr-3"}),(0,a.jsxs)("label",{htmlFor:"socialpay",className:"flex items-center cursor-pointer",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-md flex items-center justify-center mr-3",children:(0,a.jsx)("span",{className:"text-purple-600 font-semibold text-sm",children:"SP"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Social Pay"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Сошиал апп-аар төлөх"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",id:"bank",name:"paymentMethod",value:"bank",checked:"bank"===p,onChange:e=>b(e.target.value),className:"mr-3"}),(0,a.jsxs)("label",{htmlFor:"bank",className:"flex items-center cursor-pointer",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center mr-3",children:(0,a.jsx)("span",{className:"text-blue-600 font-semibold text-sm",children:"Б"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Банкны шилжүүлэг"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Удамшуулалтын мэдээлэл"})]})]})]})]}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)("button",{onClick:k,disabled:u,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:u?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white mr-2"}),"Боловсруулж байна..."]}):"₮".concat(D().toLocaleString()," төлөх")})})]})]})]})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(i.A,{}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Gig not found"})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(i.A,{}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Please login to checkout"})})]})}},6892:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return t(5620)}])}},e=>{e.O(0,[230,636,593,792],()=>e(e.s=6892)),_N_E=e.O()}]);